{% extends "layouts/default.html" %}
{% set title = campaign.title %}
{% set hasChildren = campaign.children.length > 0 %}

{% block pageNavigation %}
  {{ breadcrumb({
    items: [
      {
        text: "Home",
        href: "/dashboard"
      }
    ],
    text: "Your campaigns",
    href: "/your-campaigns"
  }) }}
{% endblock %}

{% block main %}
  <div class="nhsuk-width-container">
    <main class="nhsuk-main-wrapper" id="main-content" role="main">
      {% if success %}
        {% set html %}
          <p class="govuk-notification-banner__heading">
            New session created
          </p>
        {% endset %}
        {{ govukNotificationBanner({
          html: html,
          classes: "app-u-frutiger",
          type: "success"
        }) }}
      {% endif %}

      <h1 class="nhsuk-heading-l">
        {{ title | noOrphans | safe }}
        <span class="nhsuk-caption-l nhsuk-u-margin-top-2">{{ campaign.date | govukDate() }} at {{ campaign.date | govukTime }}</span>
      </h1>

      {% if not isOffline or campaign['available-offline'] %}
        <div class="nhsuk-grid-row">
          <div class="nhsuk-grid-column-two-thirds">
            <div class="nhsuk-card">
              <div class="nhsuk-card__content">
                {% if not data.features.pilot.on %}
                  <h2 class="nhsuk-heading-s nhsuk-u-margin-bottom-1">
                    <a href="#">Send consent requests</a>
                  </h2>
                  <p>Send vaccination consent requests and reminders to parents.</p>

                  <h2 class="nhsuk-heading-s nhsuk-u-margin-bottom-1">
                    <a href="#">Triage consent responses</a>
                  </h2>
                  <p>Check for contraindications and contact parents.</p>
                {% endif %}

                {% if not hasChildren %}
                  <h2 class="nhsuk-heading-s nhsuk-u-margin-bottom-1">
                    <a href="#">Add children</a>
                  </h2>
                  <p>Upload a list of children in this school</p>
                {% endif %}

                <h2 class="nhsuk-heading-s nhsuk-u-margin-bottom-1">
                  <a href="/campaign/{{ campaign.id }}/vaccines">Manage vaccines</a>
                </h2>
                <p>Add or change vaccines, batches and expiry dates.</p>

                {% if hasChildren %}
                  <h2 class="nhsuk-heading-s nhsuk-u-margin-bottom-1">
                    <a href="/campaign/{{ campaign.id }}/children">Record vaccinations</a>
                  </h2>
                  <p>Record vaccinations for children.</p>
                {% endif %}

                <h2 class="nhsuk-heading-s nhsuk-u-margin-bottom-1">
                  <a href="#">Edit session</a>
                </h2>
                <p>Change dates and manage access.</p>
              </div>
            </div>
          </div>
          <div class="nhsuk-grid-column-one-third">
            {% if hasChildren and not campaign['available-offline'] %}
            <div id="save-offline">
              <h2 class="nhsuk-heading-s">Save offline</h2>
              <p>Record vaccinations while not connected to the internet.</p>

              <form method="post">
                {{ button({
                  text: 'Save offline',
                  classes: 'nhsuk-u-margin-bottom-3'
                }) }}
              </form>
            </div>
            {% endif %}

            {% if campaign['available-offline'] %}
            <div id="available-offline">
              <h2 class="nhsuk-heading-s" style="color: #007f3b">
                <svg class="nhsuk-icon nhsuk-icon__tick" style="vertical-align: bottom" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" aria-hidden="true" width="34" height="34">
                  <path stroke-width="4" stroke-linecap="round" d="M18.4 7.8l-8.5 8.4L5.6 12" stroke="#007f3b"></path>
                </svg>
                Available offline
              </h2>
              <p>You can record vaccinations while not connected to the internet.</p>
              <p>Saved offline until 24 Jan 2023.</p>
            </div>
          </div>
          {% endif %}
        </div>
      {% else %}
      <div class="govuk-grid-row">
        <div class="govuk-grid-column-two-thirds">
          <div class="nhsuk-card">
            <div class="nhsuk-card__content">
              <h2 class="nhsuk-heading-m nhsuk-u-margin-bottom-2">
                <svg class="nhsuk-icon nhsuk-icon__cross" style="vertical-align: bottom" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" width="34" height="34">
                  <path d="M17 18.5c-.4 0-.8-.1-1.1-.4l-10-10c-.6-.6-.6-1.6 0-2.1.6-.6 1.5-.6 2.1 0l10 10c.6.6.6 1.5 0 2.1-.3.3-.6.4-1 .4z" fill="#d5281b"></path>
                  <path d="M7 18.5c-.4 0-.8-.1-1.1-.4-.6-.6-.6-1.5 0-2.1l10-10c.6-.6 1.5-.6 2.1 0 .6.6.6 1.5 0 2.1l-10 10c-.3.3-.6.4-1 .4z" fill="#d5281b"></path>
                </svg>
                <span style="color: #d5281b">Not available offline</span>
              </h2>
              <p>Go online to access this session</p>
            </div>
          </div>
        </div>
      </div>
      {% endif %}
    </main>
  </div>
{% endblock %}
