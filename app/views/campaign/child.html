{% extends "layouts/default.html" %}
{% set title = child.fullName %}
{% set vaccineGiven = vaccinationRecord['given'] !== 'No' %}
{% set isUnknown = child.consent.unknown or child.consent[campaign.type] == 'Unknown' %}
{% set refused = child.consent.refusedBoth or child.consent[campaign.type] == 'No' %}
{% set consented = not refused and not isUnknown %}
{% set responded = consented or refused %}

{% block pageNavigation %}
  <div class="nhsuk-width-container">
    {{ backLink({
      href: "/campaign/" + campaign.id + "/children",
      classes: "nhsuk-u-margin-top-3 nhsuk-u-margin-bottom-0"
    }) }}
  </div>
{% endblock %}

{% block main %}
  <div class="nhsuk-width-container">
    <main class="nhsuk-main-wrapper" id="main-content" role="main">
      <h1 class="nhsuk-heading-l">
        {{ title | noOrphans | safe }}
      </h1>

      <div class="nhsuk-grid-row">
        <div class="nhsuk-grid-column-two-thirds">
          {% if child.outcome == 'No outcome yet' %}
            {% if campaign.is3in1MenACWY %}
              {% include 'campaign/child/_consent-banner-3-in-1.html' %}
            {% else %}
              {% include 'campaign/child/_consent-banner.html' %}
            {% endif %}
          {% else %}
            {% include 'campaign/child/_outcome-banner.html' %}
          {% endif %}

          {% include 'campaign/child/_details.html' %}

          {% if consented %}
            {% include 'campaign/child/_health-notes.html' %}
          {% endif %}

          {% if child.outcome == 'No outcome yet' %}
            {% if isUnknown or refused %}
                {% include 'campaign/child/_action-get-consent.html' %}
            {% elseif campaign.is3in1MenACWY %}
              {% include 'campaign/child/_action-vaccinate-3-in-1.html' %}
            {% else %}
              {% include 'campaign/child/_action-vaccinate.html' %}
            {% endif %}
          {% else %}
            {% include 'campaign/child/_vaccination-recorded.html' %}
          {% endif %}

          <div class="nhsuk-card">
            <div class="nhsuk-card__content">
              {{ textarea({
                label: {
                  text: "Add notes",
                  classes: "nhsuk-label--m nhsuk-u-margin-bottom-3"
                },
                rows: 5,
                name: "notes",
                classes: "nhsuk-u-margin-bottom-0",
                decorate: ["vaccination", campaign.id, child.nhsNumber, "notes"]
              }) }}

              {{ button({
                text: "Add notes",
                classes: "nhsuk-button--secondary"
              }) }}
            </div>
          </div>
        </div>
        <div class="nhsuk-grid-column-one-third">
          {% if campaign['available-offline'] %}
          <div id="available-offline">
            <h2 class="nhsuk-heading-s" style="color: #007f3b">
              <svg class="nhsuk-icon nhsuk-icon__tick" style="vertical-align: bottom" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" aria-hidden="true" width="34" height="34">
                <path stroke-width="4" stroke-linecap="round" d="M18.4 7.8l-8.5 8.4L5.6 12" stroke="#007f3b"></path>
              </svg>
              Available offline
            </h2>
            <p>You can make changes to this childâ€™s record while not connected to the internet.</p>
          </div>
          {% endif %}
        </div>
      </div>
    </main>
  </div>
{% endblock %}
