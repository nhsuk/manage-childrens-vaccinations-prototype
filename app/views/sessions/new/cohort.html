{% extends "_layouts/wizard.html" %}

{% set title = "Select cohort for this session" %}

{% block form %}
  {{ heading({ title: title }) }}

  {% macro checkboxHtml(label) %}
    {{ checkboxes({
      formGroup: {
        classes: "nhsuk-u-margin-0"
      },
      idPrefix: "selected",
      name: "selected",
      items: [{
        html: "<span class=\"nhsuk-u-visually-hidden\">Select " + label + "</span>",
        checked: true
      }]
    }) }}
  {% endmacro %}

  {% set rows = [] %}
  {% for patient in cohort %}
    {% set rows = (rows.push([
      {
        html: checkboxHtml(patient.fullName)
      },
      {
        text: patient.fullName
      },
      {
        text: patient.dob | govukDate("truncate")
      },
      {
        text: ("Year " + patient.yearGroup) | replace("Year 0", "Reception")
      }
    ]), rows) %}
  {% endfor %}

  {{ table({
    tableClasses: "app-table--select-cohort",
    firstCellIsHeader: false,
    head: [
      { html: checkboxHtml("all") },
      { text: "Name" },
      { text: "Date of birth" },
      { text: "Year group" }
    ],
    rows: rows
  }) }}
{% endblock %}
