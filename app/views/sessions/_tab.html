<div class="nhsuk-grid-row">
  <div class="nhsuk-grid-column-one-quarter">
    {% include "sessions/_filters.html" %}
  </div>
  <div class="nhsuk-grid-column-three-quarters">
    {% if tab.results.length %}
      <table class="nhsuk-table app-table--patients" id="patients">
        <thead class="nhsuk-table__head">
          <tr class="nhsuk-table__row">
            <th class="nhsuk-table__header">Name</th>
            <th class="nhsuk-table__header app-u-nowrap">Date of birth</th>
            {% if isRefusalReasonNeeded %}
            <th class="nhsuk-table__header">Reason for refusal</th>
            {% endif %}
            {% if tab.statusColumn %}
            <th class="nhsuk-table__header">{{ tab.statusColumn }}</th>
            {% endif %}
          </tr>
        </thead>
        <tbody class="nhsuk-table__body">
          {% for patient in tab.results %}
            <tr class="nhsuk-table__row">
              <td class="nhsuk-table__cell">
                <a href="/sessions/{{ session.id }}/patient/{{ patient.nhsNumber }}?referrer={{ section }}">{{ patient.fullName }}</a>
                {% if patient.knownAs %}
                  <br><span class="nhsuk-u-font-size-16">Known as: {{ patient.knownAs }}</span>
                {% endif %}
                {% if patient.outcome == PATIENT_OUTCOME.COULD_NOT_VACCINATE %}
                  <br><span class="nhsuk-u-font-size-16 nhsuk-u-secondary-text-color">Refusal confirmed</span>
                {% endif %}
              </td>
              <td class="nhsuk-table__cell nhsuk-u-font-size-16">
                {{ patient.dob | govukDate("truncate") }}
              </td>
              {% if isRefusalReasonNeeded %}
              <td class="nhsuk-table__cell nhsuk-u-font-size-16">
                {% for reason in patient.consent.refusalReasons %}
                  {{ reason | noOrphans | safe }}
                  {% if not loop.last %}<br>{% endif %}
                {% endfor %}
              </td>
              {% endif %}
              {% if tab.statusColumn %}
              <td class="nhsuk-table__cell">
                {{ tag({
                  text: action(patient).text,
                  classes: "nhsuk-tag--" + action(patient).colour + " nhsuk-u-font-size-16 nhsuk-u-width-full"
                }) if tab.statusColumn == "Action needed" else tag({
                  text: outcome(patient).text,
                  classes: "nhsuk-tag--" + outcome(patient).colour + " nhsuk-u-font-size-16 nhsuk-u-width-full"
                }) }}
              </td>
              {% endif %}
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      {% set descriptionHtml %}
        <p class="nhsuk-body">We couldnâ€™t find any children that matched your filters.</p>
        <p class="nhsuk-body"><a href="?">Remove filter</a></p>
      {% endset %}
      {{ card({
        heading: "No results",
        descriptionHtml: descriptionHtml
      }) }}
    {% endif %}
  </div>
</div>
